openHAB 2.0 configuration
======================

This is a base set of configuration. The rules are depending on a naming convention.

  * [openHAB 2\.0 configuration](#openhab-20-configuration)
  * [file organisation](#file-organisation)
  * [rules](#rules)
    * [auto mode](#auto-mode)
    * [boost mode](#boost-mode)
    * [towel dryer](#towel-dryer)
    * [Item naming convention](#item-naming-convention)
      * [base stuff](#base-stuff)
      * [heating](#heating)
      * [sensor data](#sensor-data)
      * [moving average](#moving-average)
  * [Logging](#logging)
  
*TOC generated by https://github.com/ekalinin/github-markdown-toc.go*


# file organisation

**Items** are organized by rooms. If you need a new room, copy&paste an existing one an search%replace the room prefix (e.g. bath -> kitchen)

**Rules** are organized by responsibility. For example all heating stuff in the heating.rules

rules
====

## auto mode
Activates and deactivates heating to meet the target temperature.

## boost mode
Activates heating for a given period independently of the target temperature. For example for a towel dryer or after ventilation.

## towel dryer
The towel dryer is connected to the floor heating of the bath. Therefore the "towel dryer mode" is just an activation of the bath floor heating.

## Item naming convention
The naming convention for items is: **basename_suffix**
basename is the spatial location. For example: bath, bedroom, garden, garage
suffix is the special item for the "basename". For example: heating, thermostat, window1, ...
Please use the defined suffixes for all basenames because the rules und functions are depending on this suffixes.

| Type | Suffix | Description |
| --- | --- | --- |
| Group | _group | Group for all items in this room |
| Group | _chart | Group for all charts for this room |
| Number | _chart_period | For period switch of the chart |
| Number | _heating_stateForChart | The state of the heating to display in a chart. The Value is based on the target temperature to get a good scaling. |

### base stuff
| Type | Suffix | Description |
| --- | --- | --- |
| Number | _thermostat | The target temperature for the room |
| Number | _hyst | The hysteresis for the room |
| Number | _temperature | The temperature of the room |
| Number | _humidity | The hymidity of the room |
| Contact | _window | The contact for a window. You can create additional contacts |

### heating
| Type | Suffix | Description |
| --- | --- | --- |
| Switch | _heating | The switch to activate and deactivate the heating |
| Number | _heating_state | The state (0 or 1) for the heating used in charts and to calculate state for a given time range |
| Switch | _heating_auto | Switch to activate auto heating and keep target temperature |
| Switch | _heating_auto_overwrite | Switch to temporary overwrite auto heating mode (for example for towel dryer) |
| Switch | _heating_boost | Switch to activate boost mode |
| Number | _heating_boost_period | Time in seconds for active boost mode |

### sensor data
| Type | Suffix | Description |
| --- | --- | --- |
| DateTime | _sensor_update |  Timestamp of the last sesnsor update |
| Number | _sensor_battery | Battery level of the sensor |


### moving average
For the floor heating delay. The moving average (multiplied with the factor) is added to the current temperature.
Reason: If the floor heating is active, the heat will "arrive" in the room with a time delay. To prevent overheating the moving average is used.

| Type | Suffix | Description |
| --- | --- | --- |
| Number | _heating_moveavg_duration | Timespan to calculate the the moving average for |
| Number | _heating_moveavg_factor | Factor multiplied to the moving average  |
| Number | _heating_moveavg_chart | The moving average for the chart (without factor but scaled for the chart). |


Logging
=======

Set log level and view logs in the console:

	log:set DEBUG org.eclipse.smarthome.model.script.bath
	log:tail

Add log level for custom logger. Edit file: *userdata\etc\org.ops4j.pax.logging.cfg*

	log4j.logger.org.eclipse.smarthome.model.script.bath = DEBUG
	log4j.logger.org.eclipse.smarthome.model.script.heating = DEBUG
	log4j.logger.org.eclipse.smarthome.model.script.simulate = DEBUG

